upstream loyalty-club  {
    server    unix:/home/vagrant/tmp/loyalty-club.sock;
}
upstream watchman-api  {
    server    unix:/home/vagrant/tmp/watchman-api.sock;
}
upstream earaujoassis  {
    server    localhost:4567;
}

server {
    listen 80 default_server;
    listen [::]:80 default_server ipv6only=on;
    root /usr/share/nginx/html;
    index index.html index.htm;
    server_name local.ewerton-araujo.com;

    location / {
        try_files $uri $uri/ =404;
    }
}

server {
    listen 80;
    server_name loyalty-club.local.ewerton-araujo.com;

    location / {
        proxy_pass  http://loyalty-club;
        proxy_next_upstream error timeout invalid_header http_500 http_502 http_503 http_504;
        proxy_redirect off;
        proxy_buffering off;
        proxy_set_header        Host            loyalty-club.local.ewerton-araujo.com;
        proxy_set_header        X-Real-IP       $remote_addr;
        proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
server {
    listen 80;
    server_name watchman-api.local.ewerton-araujo.com;

    location / {
        proxy_pass  http://watchman-api;
        proxy_next_upstream error timeout invalid_header http_500 http_502 http_503 http_504;
        proxy_redirect off;
        proxy_buffering off;
        proxy_set_header        Host            watchman-api.local.ewerton-araujo.com;
        proxy_set_header        X-Real-IP       $remote_addr;
        proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
server {
    listen 80;
    server_name earaujoassis.local.ewerton-araujo.com;

    location / {
        proxy_pass  http://earaujoassis;
        proxy_next_upstream error timeout invalid_header http_500 http_502 http_503 http_504;
        proxy_redirect off;
        proxy_buffering off;
        proxy_set_header        Host            earaujoassis.local.ewerton-araujo.com;
        proxy_set_header        X-Real-IP       $remote_addr;
        proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
